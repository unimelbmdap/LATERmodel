---
title: "Analysis of 'Neural computation of log likelihood in control of saccadic eye movements'"
bibliography: cw1995_analysis.bib
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup, echo = FALSE, results = "hide", message = FALSE}
library(LATERmodel)
#library(devtools)
#load_all()
```

```{r echo = FALSE, results = "hide", message = FALSE}
library(printr)
```

Here, we will walk through the analysis of some example data from the article "Neural computation of log likelihood in control of saccadic eye movements" by @Carpenter1995.
We will be particularly interested in analysing the data from participant *a*, as shown in the figure below (their Figure 2a).

```{r echo = FALSE, fig.align = "center", out.width = "75%"}
knitr::include_graphics("cw1995_fig2a.png")
```


## Loading the raw data

A digitised version of the raw data from this study is included in this package in the `carpenter_williams_1995` variable.
The help documentation for this data describes its contents and format:

<!-- printr.help.sections = "format" -->
```{r}
help(carpenter_williams_1995)
```

Because we are only interested in participant *a* here, we will first extract only their data from this variable and then have a look at the first few rows:
```{r}
raw_data <- subset(x = carpenter_williams_1995, participant == "a")
print(head(raw_data))
```

## Pre-processing the data

The functions within this `LATERmodel` package expect the data to be in a particular format which does not correspond to the format of `raw_data`.
We can use the `prepare_data` function to convert the data into this expected format:

```{r}
data <- LATERmodel::prepare_data(rt = raw_data)
print(head(data))
```

As shown above, ...

To make the condition names match those used in @Carpenter1995, we can recode them:

```{r}
# make the names match C&W
data$name <- dplyr::recode_factor(
  .x = data$name,
  a_p05 = "5%",
  a_p10 = "10%",
  a_p25 = "25%",
  a_p50 = "50%",
  a_p75 = "75%",
  a_p90 = "90%",
  a_p95 = "95%")
```

## Visualising the observed data

We can use the `LATERmodel::reciprobit_plot` function to visualise the observed data.
As shown below, this produces a figure in a similar format to the visualisation in @Carpenter1995.

```{r fig.show='hold', out.width = c("50%", "50%"), message = FALSE, warning = FALSE}
knitr::include_graphics("cw1995_fig2a.png")
plot <- reciprobit_plot(
  plot_data = data,
  probit_breaks = c(0.1, 0.5, 1, 2, 5, 10, 20, 30, 50, 70, 80, 90, 95, 98, 99, 99.5, 99.9),
  time_breaks = c(100, 150, 200, 300, 500, 1000) / 1000)
plot + ggplot2::coord_cartesian(
  xlim = c(1 / 0.1, 1 / 2),
  ylim = c(0.1 / 100, 99.9 / 100),
  expand = FALSE,
  clip = "off")
```

```{r}
data_p05 <- subset(x = data, name == "5%")
fit_p05 <- LATERmodel::fit_data(data = data_p05)
#fit_p05$named_fit_params$name <- as.factor(x = rownames(x = fit_p05$named_fit_params))
#fit_p05$named_fit_params$color <- unique(data_p05$color)
#fit_p05$named_fit_params <- as.data.frame(fit_p05$named_fit_params)
#print(fit_p05$named_fit_params)
#print(individual_later_fit(data_p05))
#LATERmodel::reciprobit_plot(plot_data = data_p05, fit_params = fit_p05$named_fit_params)
```

```{r}
#LATERmodel::reciprobit_plot(plot_data = data_p05, fit_params = individual_later_fit(data_p05))

```

## References